build:
  cache: true
  ci:
    - echo 'we could do the auth tests, but everything else requires an elasticsearch'
  post_ci:
      - docker build -t="opentargets/rest_api:$BRANCH.$BUILD_NUMBER" .

      # Pushing to 2 different registries
      # DockerHub
      - docker push opentargets/shippable-rest_api:$BRANCH

      # GCR.io
#      - docker tag opentargets/rest_api:$BRANCH eu.gcr.io/open-targets/rest_api:$BRANCH
#      - docker push eu.gcr.io/open-targets/rest_api:$BRANCH

  hub:
    - integrationName: hub_docker
      type: docker
    - integrationName: gcr_io
      type: gcr

